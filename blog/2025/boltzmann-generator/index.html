<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Boltzmann distributions and generative models | GDL blog post </title> <meta name="author" content="Seonghyun Park"> <meta name="description" content="generative models for learning the boltzmann distribution"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/seonghyun26-gdl-post/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/seonghyun26-gdl-post/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/seonghyun26-gdl-post/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/seonghyun26-gdl-post/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%92%8A&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/seonghyun26-gdl-post/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://seonghyun26.github.io/seonghyun26-gdl-post/blog/2025/boltzmann-generator/"> <script src="/seonghyun26-gdl-post/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/seonghyun26-gdl-post/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" integrity="sha256-q9ba7o845pMPFU+zcAll8rv+gC+fSovKsOoNQ6cynuQ=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css" integrity="sha256-Oppd74ucMR5a5Dq96FxjEzGF7tTw2fZ/6ksAqDCM8GY=" crossorigin="anonymous" media="screen and (prefers-color-scheme: light)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" integrity="sha256-nyCNAiECsdDHrr/s2OQsp5l9XeY2ZJ0rMepjCT2AkBk=" crossorigin="anonymous" media="screen and (prefers-color-scheme: dark)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/css/diff2html.min.css" integrity="sha256-IMBK4VNZp0ivwefSn51bswdsrhk0HoMTLc2GqFHFBXg=" crossorigin="anonymous"> <link defer rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css"> <script src="/seonghyun26-gdl-post/assets/js/distillpub/template.v2.js"></script> <script src="/seonghyun26-gdl-post/assets/js/distillpub/transforms.v2.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Boltzmann distributions and generative models",
            "description": "generative models for learning the boltzmann distribution",
            "published": "May 28, 2025",
            "authors": [
              
              {
                "author": "Seonghyun Park",
                "authorURL": "",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/seonghyun26-gdl-post//"> GDL blog post </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/seonghyun26-gdl-post/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/seonghyun26-gdl-post/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/seonghyun26-gdl-post/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/seonghyun26-gdl-post/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/seonghyun26-gdl-post/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/seonghyun26-gdl-post/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/seonghyun26-gdl-post/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/seonghyun26-gdl-post/people/">people </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/seonghyun26-gdl-post/books/">bookshelf</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/seonghyun26-gdl-post/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Boltzmann distributions and generative models</h1> <p>generative models for learning the boltzmann distribution</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#introduction">Introduction</a> </div> <div> <a href="#molecular-systems-and-the-boltzmann-distribution">Molecular systems and the Boltzmann distribution</a> </div> <div> <a href="#boltzmann-generators">Boltzmann generators</a> </div> <div> <a href="#transferable-boltzmann-generators">Transferable Boltzmann Generators</a> </div> <div> <a href="#conclusion">Conclusion</a> </div> </nav> </d-contents> <h2 id="introduction">Introduction</h2> <p>Boltzmann Generators (BG) have emerged as powerful generative models that bridge statistical mechanics and deep learning. These innovative tools address the fundamental challenge of sampling molecular configurations efficiently from complex, high-dimensional energy landscapes. In this post, we provide an in-depth overview of molecular systems, the Boltzmann distribution, and how Boltzmann Generators learn and generate configurations adhering to this distribution. Furthermore, we explore recent advancements, particularly Transferable Boltzmann Generators (TBG), highlighting improvements in sampling efficiency and generalizability across diverse molecular systems.</p> <h2 id="molecular-systems-and-the-boltzmann-distribution">Molecular systems and the Boltzmann distribution</h2> <blockquote> <p>Goal: sampling in high-dimensional energy landscapes</p> </blockquote> <p>Consider a molecular system consisting of \(N\) atoms, where the configuration of each atom is represented by coordinates \(x \in \mathbb{R}^{3 N}\). In statistical mechanics, the equilibrium probability of observing a particular configuration follows the Boltzmann distribution:</p> \[\mu(x) \sim \operatorname{exp} \big(-\frac{U(x)}{k_{B}T}\big)\] <p>where each symbol denotes the following.</p> <ul> <li> <p>\(U(x)\): the potential energy associated with configuration</p> </li> <li> <p>\(k_{B}\): the Boltzmann constant</p> </li> <li> <p>\(T\): the temperature</p> </li> </ul> <p>Intuitively, configurations with lower energy are more probable, whereas configurations with higher energy are exponentially less likely. While efficiently sampling from this distribution is crucial for understanding molecular behavior, thermodynamics, and reaction dynamics, samples with high energy makes this challenging.</p> <h3 id="alanine-dipeptide">Alanine Dipeptide</h3> <p>For instance, consider the Ramachandran plot for Alanine Dipeptide, a simplified model peptide frequently studied in molecular dynamics. The Ramachandran plot illustrates energetically favorable regions (valleys) and unfavorable regions (mountains), visually representing the Boltzmann distribution in torsional angle space \(\phi\) and \(\psi\).</p> <h2 id="boltzmann-generators-bg">Boltzmann generators (BG)</h2> <blockquote> <p>TL;DR configuration generation with invertible networks, trained with energy and samples.</p> </blockquote> <p>Boltzmann generators (BG) learns the Boltzmann distribution with the following main three components:</p> <ul> <li>training by energy</li> <li>training by example</li> <li>inveritble network</li> </ul> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/seonghyun26-gdl-post/assets/img/bg-480.webp 480w,/seonghyun26-gdl-post/assets/img/bg-800.webp 800w,/seonghyun26-gdl-post/assets/img/bg-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/seonghyun26-gdl-post/assets/img/bg.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="boltzmann generators" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Overview of Boltzmann generators </div> <h3 id="training-by-energy">Training by Energy</h3> <p>Boltzmann Generators leverage the explicit energy function \(U(x)\) to guide learning. The training objective often involves minimizing the Kullback–Leibler divergence between the generated distribution and the true Boltzmann distribution, expressed as:</p> \[\mathcal{L}_{KL} = \mathbb{E}_{z \sim q_{z}} \Big[ \beta U(F(z)) - \operatorname{log}\operatorname{det}\Big\vert \frac{F(z)}{z} \Big\vert \Big]\] <p>where \(\beta\) denotes the inverse temperature, i.e., \(\beta = 1 / (k_{B}T)\).</p> <h3 id="training-by-example">Training by Example</h3> <p>To overcome the limitations of energy-based training alone (such as mode collapse), BGs often integrate example-based training using molecular dynamics or Monte Carlo samples. This hybrid approach ensures that the model adequately captures multiple low-energy configurations and effectively covers the energy landscape.</p> <h3 id="invertible-networks-normalizing-flows">Invertible Networks (Normalizing Flows)</h3> <p>At the heart of BGs lies the concept of normalizing flows, invertible neural networks capable of efficiently transforming simple latent distributions into complex, high-dimensional molecular configurations. By maintaining invertibility, these networks allow explicit probability calculations necessary for accurate sampling and reweighting.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/seonghyun26-gdl-post/assets/img/RealNVP-480.webp 480w,/seonghyun26-gdl-post/assets/img/RealNVP-800.webp 800w,/seonghyun26-gdl-post/assets/img/RealNVP-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/seonghyun26-gdl-post/assets/img/RealNVP.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="boltzmann generators" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Overview of Boltzmann generators </div> <h3 id="experiments">Experiments</h3> <p>BGs presents configuration generation on xxx.</p> <h2 id="transferable-boltzmann-generators-tbg">Transferable Boltzmann Generators (TBG)</h2> <blockquote> <p>TL;DR Full atom coordinate generation with flow matching, transferable between dipeptides.</p> </blockquote> <p>Transferable Boltzmann Generators extend the capabilities of traditional Boltzmann Generators by incorporating innovations that improve sampling efficiency and enable generalization across multiple molecular systems. Specifically, TBG introduces:</p> <ul> <li>Flow matching</li> <li>Full atom coordinate generation</li> <li>Transferablility among dipeptides</li> </ul> <h3 id="flow-matching">Flow matching</h3> <p>Previously, the boltzmann generator used an ``RealNVP’’ to learn the flow. Extending from this, TBG replaces this process with flow matching.</p> <h3 id="full-atom-coordinate-generation">Full atom Coordinate Generation</h3> <p>Boltzman generators have used ``internal coordinates’’, i.e., atom-wise distance and torsion angles, for representations.</p> <h3 id="transferability-among-dipeptides">Transferability among Dipeptides</h3> <p>Another notable contribution of TBGs is the transferability among dipeptides.</p> <h2 id="conclusion">Conclusion</h2> <p>Boltzmann Generators (BG) represent a transformative integration of statistical mechanics and deep learning, addressing critical challenges in efficient sampling from high-dimensional molecular energy landscapes. Continuous advancements such as Transferable Boltzmann Generators (TBG) further enhance the efficiency, accuracy, and generalizability of these powerful models. As these methodologies evolve, researchers gain increasingly robust tools to explore complex molecular behaviors, profoundly impacting fields like computational chemistry, drug discovery, and materials science.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/seonghyun26-gdl-post/assets/bibliography/2025-05-28-bg.bib"></d-bibliography> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'seonghyun26/seonghyun26-gdl-post',
        'data-repo-id': '',
        'data-category': 'Comments',
        'data-category-id': '',
        'data-mapping': 'title',
        'data-strict': '1',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Seonghyun Park. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/seonghyun26-gdl-post/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script defer src="/seonghyun26-gdl-post/assets/js/mermaid-setup.js?38ca0a0126f7328d2d9a46bad640931f" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/js/diff2html-ui.min.js" integrity="sha256-eU2TVHX633T1o/bTQp6iIJByYJEtZThhF9bKz/DcbbY=" crossorigin="anonymous"></script> <script defer src="/seonghyun26-gdl-post/assets/js/diff2html-setup.js?80a6e52ce727518bbd3aed2bb6ba5601" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js" integrity="sha256-MgH13bFTTNqsnuEoqNPBLDaqxjGH+lCpqrukmXc8Ppg=" crossorigin="anonymous"></script> <script defer src="/seonghyun26-gdl-post/assets/js/leaflet-setup.js?b6313931e203b924523e2d8b75fe8874" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-0q+JdOlScWOHcunpUk21uab1jW7C1deBQARHtKMcaB4=" crossorigin="anonymous"></script> <script defer src="/seonghyun26-gdl-post/assets/js/chartjs-setup.js?183c5859923724fb1cb3c67593848e71" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js" integrity="sha256-QvgynZibb2U53SsVu98NggJXYqwRL7tg3FeyfXvPOUY=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/theme/dark-fresh-cut.js" integrity="sha256-sm6Ui9w41++ZCWmIWDLC18a6ki72FQpWDiYTDxEPXwU=" crossorigin="anonymous"></script> <script defer src="/seonghyun26-gdl-post/assets/js/echarts-setup.js?738178999630746a8d0cfc261fc47c2c" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega@5.27.0/build/vega.min.js" integrity="sha256-Yot/cfgMMMpFwkp/5azR20Tfkt24PFqQ6IQS+80HIZs=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-lite@5.16.3/build/vega-lite.min.js" integrity="sha256-TvBvIS5jUN4BSy009usRjNzjI1qRrHPYv7xVLJyjUyw=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-embed@6.24.0/build/vega-embed.min.js" integrity="sha256-FPCJ9JYCC9AZSpvC/t/wHBX7ybueZhIqOMjpWqfl3DU=" crossorigin="anonymous"></script> <script defer src="/seonghyun26-gdl-post/assets/js/vega-setup.js?7c7bee055efe9312afc861b128fe5f36" type="text/javascript"></script> <script defer src="https://tikzjax.com/v1/tikzjax.js" integrity="sha256-+1qyucCXRZJrCg3lm3KxRt/7WXaYhBid4/1XJRHGB1E=" crossorigin="anonymous"></script> <script src="/seonghyun26-gdl-post/assets/js/typograms.js?062e75bede72543443762dc3fe36c7a5"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/seonghyun26-gdl-post/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/seonghyun26-gdl-post/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/seonghyun26-gdl-post/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/seonghyun26-gdl-post/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/seonghyun26-gdl-post/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/seonghyun26-gdl-post/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/seonghyun26-gdl-post/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/seonghyun26-gdl-post/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/seonghyun26-gdl-post/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/seonghyun26-gdl-post/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/seonghyun26-gdl-post/assets/js/search-data.js"></script> <script src="/seonghyun26-gdl-post/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>